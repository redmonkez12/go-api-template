package user

import (
	"errors"
	"time"

	"github.com/google/uuid"
)

var (
	ErrNotFound       = errors.New("user not found")
	ErrDuplicateEmail = errors.New("email already exists")
)

type User struct {
	ID                      uuid.UUID  `json:"id"`
	Email                   string     `json:"email"`
	PasswordHash            string     `json:"-"` // Never expose password hash in JSON
	EmailVerified           bool       `json:"email_verified"`
	EmailVerificationToken  *string    `json:"-"`
	EmailVerificationSentAt *time.Time `json:"-"`
	CreatedAt               time.Time  `json:"created_at"`
	UpdatedAt               time.Time  `json:"updated_at"`
{{if .HasOAuth}}	AuthProvider            string     `json:"auth_provider"`
	ProviderUserID          string     `json:"provider_user_id,omitempty"`
{{end}}}
